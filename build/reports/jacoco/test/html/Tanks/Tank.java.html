<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Tank.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">01_Assignment</a> &gt; <a href="index.source.html" class="el_package">Tanks</a> &gt; <span class="el_source">Tank.java</span></div><h1>Tank.java</h1><pre class="source lang-java linenums">package Tanks;

import java.util.ArrayList;

import processing.core.PApplet;
import processing.core.PFont;
import processing.core.PImage;

public class Tank {
    /**
     * The name of the tank
     */
    private String tankName;
    /**
     * Starting column position of the tank
     */
    private int col;
    /**
     * Starting row position of the tank
     */
    private int row;
    /**
     * X position of the tank
     */
    private int xPos;
    /**
     * X position of the turret
     */
    private int xPosTurret;
    /**
     * X position where tank is exploded
     */
    private int xPosExploded;
    /**
     * Y position of the tank
     */
    private float yPos;
    /**
     * Y position of the turret
     */
    private float yPosTurret;
    /**
     * Y position where tank is exploded
     */
    private float yPosExploded;
    /**
     * The actual width size of tank
     */
<span class="fc" id="L49">    private int xSize = 20;</span>
    /**
     * The actual height size of the tank
     */
<span class="fc" id="L53">    private int ySize = 15;</span>
    /**
     * The actual width size of parachute
     */
<span class="fc" id="L57">    private int xParachuteSize = 60;</span>
    /**
     * The actual height size of parachute
     */
<span class="fc" id="L61">    private int yParachutSize = 60;</span>
    /**
     * The number of parachute tank has
     */
    private int parachute;
    /**
     * The actual turret length
     */
<span class="fc" id="L69">    private int turretLength = 15;</span>
    /**
     * The actual turret width
     */
<span class="fc" id="L73">    private int turretWidth = 5;</span>
    /**
     * The turret angle
     */
    private float turretAngle;
    /**
     * Red color code in RGB
     */
    private int redRGB;
    /**
     * Blye color code in RGB
     */
    private int blueRGB;
    /**
     * Green color code in RGB
     */
    private int greenRGB;
    /**
     * Tank alive or dead
     */
    private boolean isAlive;
    /**
     * Parachute has been deployed or not
     */
    private boolean isParachuteDeployed;
    /**
     * The tank explosion has been exploded or not
     */
    private boolean createdExplosion;
    /**
     * Tank current state of firing large projectile
     */
    private boolean largeProjectile;
    /**
     * The damage from free drop
     */
    private float freeDropDamage;
    /**
     * Angle measured in Radians
     */
    private float angleInRadians;
    /**
     * Health of the tank
     */
    private float health;
    /**
     * Power of the tank
     */
    private float power;
    /**
     * Fuel of the tank
     */
    private int fuel;
    /**
     * The repair value the tank benefits
     */
    private static final int repairHealthPowerup = 20;
    /**
     * The fuel value the tank received
     */
    private static final int fuelPowerup = 200;
    /**
     * The cost of moving tank in fuel
     */
    private static final int moveCost = 1;
    /**
     * The speed of the tank
     */
<span class="fc" id="L141">    private static final float moveSpeed = 60 / App.getFPS();</span>
    /**
     * The speed of the change in power
     */
<span class="fc" id="L145">    private static final float powerChangeSpeed = 36 / App.getFPS();</span>
    /**
     * The speed of tank with parachute
     */
<span class="fc" id="L149">    private static final float parachuteSpeed = 60 / App.getFPS();</span>
    /**
     * The speed of tank without parachute (free drop)
     */
<span class="fc" id="L153">    private static final float freeDropSpeed = 120 / App.getFPS();</span>
    /**
     * The speed of turret rotation
     */
    private static final float turretRotateSpeed = 3 * 180 / (float) Math.PI; // rad per second

    /**
     * Create new tank
     * 
     * @param startCol starting column
     * @param startRow starting row
     * @param tankName the name of the tank
     */
<span class="fc" id="L166">    public Tank(int startCol, int startRow, String tankName) {</span>
<span class="fc" id="L167">        this.tankName = tankName;</span>
<span class="fc" id="L168">        this.col = startCol;</span>
<span class="fc" id="L169">        this.row = startRow;</span>
<span class="fc" id="L170">        this.xPos = startCol * App.getCell(&quot;width&quot;);</span>
<span class="fc" id="L171">        this.yPos = startRow * App.getCell(&quot;height&quot;);</span>
<span class="fc" id="L172">        this.isAlive = true;</span>
<span class="fc" id="L173">        this.health = 100.0f;</span>
<span class="fc" id="L174">        this.power = 50f;</span>
<span class="fc" id="L175">        this.fuel = 250;</span>
<span class="fc" id="L176">        this.parachute = 3;</span>
<span class="fc" id="L177">        this.largeProjectile = false;</span>
<span class="fc" id="L178">        turretAngle = 90;</span>
<span class="fc" id="L179">    }</span>

    /**
     * The action that tank performs every tick
     */
    public void tick() {
<span class="fc" id="L185">        explosionPosAdjust();</span>
<span class="fc" id="L186">        setPower(&quot;check&quot;);</span>
<span class="fc" id="L187">        isAlive();</span>
<span class="fc" id="L188">    }</span>

    /**
     * Draw the tank, parachute and indication for large projectile
     * 
     * @param app app
     */
    public void draw(PApplet app) {

<span class="pc bpc" id="L197" title="1 of 4 branches missed.">        if (isAlive &amp;&amp; !createdExplosion) {</span>
<span class="pc bpc" id="L198" title="1 of 2 branches missed.">            if (isParachuteDeployed) {</span>
<span class="nc" id="L199">                PImage parachuteImage = app.loadImage(&quot;src/main/resources/Tanks/parachute.png&quot;);</span>
<span class="nc" id="L200">                app.image(parachuteImage, xPos - xParachuteSize / 2, yPos - yParachutSize, xParachuteSize,</span>
                        yParachutSize);
            }

<span class="pc bpc" id="L204" title="1 of 2 branches missed.">            if (largeProjectile) {</span>
<span class="nc" id="L205">                PFont largeProjectile = app.createFont(&quot;Calibri Bold&quot;, 70);</span>
<span class="nc" id="L206">                app.textFont(largeProjectile);</span>
<span class="nc" id="L207">                app.fill(redRGB, greenRGB, blueRGB);</span>
<span class="nc" id="L208">                app.text(&quot;+&quot;, xPos - 15, yPos - 50);</span>
            }

<span class="fc" id="L211">            app.fill(redRGB, greenRGB, blueRGB);</span>
<span class="fc" id="L212">            app.stroke(0, 0, 0);</span>
<span class="fc" id="L213">            app.strokeWeight(1);</span>
<span class="fc" id="L214">            app.ellipse(xPos, yPos, xSize, ySize);</span>

<span class="fc" id="L216">            app.noFill();</span>
<span class="fc" id="L217">            app.stroke(0, 0, 0);</span>
<span class="fc" id="L218">            app.strokeWeight(turretWidth);</span>
<span class="fc" id="L219">            app.line(xPos, yPos, xPosTurret, yPosTurret);</span>
        }
<span class="fc" id="L221">    }</span>

    /**
     * Adjust the tank position after taking the explosion
     */
    public void explosionPosAdjust() {
<span class="fc" id="L227">        float yPosNow = App.getTerrainHeight(xPos, &quot;pixel&quot;);</span>
<span class="fc" id="L228">        float yDif = yPosNow - yPos;</span>
        // System.out.println(yDif);

<span class="fc bfc" id="L231" title="All 2 branches covered.">        if (yDif &lt;= 0) {</span>
<span class="fc" id="L232">            isParachuteDeployed = false;</span>
<span class="fc" id="L233">            return;</span>
        }

<span class="pc bpc" id="L236" title="2 of 4 branches missed.">        if (!isParachuteDeployed &amp;&amp; parachute &gt; 0) {</span>
<span class="fc" id="L237">            isParachuteDeployed = true;</span>
<span class="fc" id="L238">            parachute--;</span>
        }

<span class="pc bpc" id="L241" title="1 of 2 branches missed.">        if (isParachuteDeployed) {</span>
<span class="fc" id="L242">            yPos += parachuteSpeed;</span>

        } else {
<span class="nc" id="L245">            yPos += freeDropSpeed;</span>
<span class="nc" id="L246">            health -= yDif;</span>
<span class="nc" id="L247">            freeDropDamage = yDif;</span>
        }
<span class="fc" id="L249">        rotateTurret(0);</span>
<span class="fc" id="L250">    }</span>

    /**
     * Set the correct tank color
     * 
     * @param colors all colors available
     */
    public void setTankColor(ArrayList&lt;Color&gt; colors) {

<span class="pc bpc" id="L259" title="1 of 2 branches missed.">        if (colors == null) {</span>
<span class="nc" id="L260">            return;</span>
        }

<span class="fc bfc" id="L263" title="All 2 branches covered.">        for (Color color : colors) {</span>
<span class="fc" id="L264">            String owner = color.getOwnerName();</span>
<span class="fc" id="L265">            int[] colorArray = color.getColorCode();</span>

<span class="fc bfc" id="L267" title="All 2 branches covered.">            if (this.tankName.equals(owner)) {</span>
<span class="fc" id="L268">                redRGB = colorArray[0];</span>
<span class="fc" id="L269">                greenRGB = colorArray[1];</span>
<span class="fc" id="L270">                blueRGB = colorArray[2];</span>
                // System.out.println(redRGB + &quot;, &quot; + greenRGB + &quot;, &quot; + blueRGB);
            }
<span class="fc" id="L273">        }</span>
<span class="fc" id="L274">    }</span>

    /**
     * Use the power up
     * 
     * @param type the type of power up used
     */
    public void powerUp(String type) {
<span class="fc bfc" id="L282" title="All 2 branches covered.">        if (type.equals(&quot;repair&quot;)) {</span>
<span class="fc" id="L283">            health += repairHealthPowerup;</span>

<span class="fc bfc" id="L285" title="All 2 branches covered.">            if (health &gt; 100) {</span>
<span class="fc" id="L286">                health = 100;</span>
            }
<span class="fc bfc" id="L288" title="All 2 branches covered.">        } else if (type.equals(&quot;fuel&quot;)) {</span>
<span class="fc" id="L289">            fuel += fuelPowerup;</span>
<span class="fc bfc" id="L290" title="All 2 branches covered.">        } else if (type.equals(&quot;parachute&quot;)) {</span>
<span class="fc" id="L291">            parachute++;</span>
<span class="pc bpc" id="L292" title="1 of 2 branches missed.">        } else if (type.equals(&quot;largeProjectile&quot;)) {</span>
<span class="fc" id="L293">            setLargeProjectile(&quot;on&quot;);</span>
        }
<span class="fc" id="L295">    }</span>

    /**
     * Move the tank
     * 
     * @param side right or left
     */
    public void move(String side) {
<span class="fc" id="L303">        int width = App.getBoard(&quot;width&quot;);</span>

<span class="pc bpc" id="L305" title="1 of 2 branches missed.">        if (fuel &lt; moveCost) {</span>
<span class="nc" id="L306">            return;</span>
        }
<span class="fc bfc" id="L308" title="All 2 branches covered.">        if (side.equals(&quot;right&quot;)) {</span>
<span class="fc" id="L309">            xPos += moveSpeed;</span>
<span class="pc bpc" id="L310" title="1 of 2 branches missed.">            if (xPos &gt;= width) {</span>
<span class="nc" id="L311">                xPos = width;</span>
            }

<span class="pc bpc" id="L314" title="2 of 4 branches missed.">        } else if (side.equals(&quot;left&quot;) &amp;&amp; xPos - moveSpeed &gt; 0) {</span>
<span class="fc" id="L315">            xPos -= moveSpeed;</span>
        }

<span class="fc" id="L318">        yPosAdjust();</span>
<span class="fc" id="L319">        rotateTurret(0);</span>
<span class="fc" id="L320">        fuel--;</span>

<span class="fc" id="L322">    }</span>

    /**
     * Rotate the turret
     * 
     * @param side clockwise(1), counter-clockwise(-1) or no change(0)
     */
    public void rotateTurret(int side) {
<span class="fc" id="L330">        double deltaAngle = turretRotateSpeed / App.getFPS();</span>

        // 1 = clockwise, -1 = counter-clockwise, 0 = no change
<span class="fc bfc" id="L333" title="All 2 branches covered.">        if (side == 1) {</span>
<span class="fc" id="L334">            turretAngle += deltaAngle;</span>
<span class="fc bfc" id="L335" title="All 2 branches covered.">            if (turretAngle &gt;= 180) {</span>
<span class="fc" id="L336">                turretAngle = 180;</span>
            }
<span class="fc bfc" id="L338" title="All 2 branches covered.">        } else if (side == -1) {</span>
<span class="fc" id="L339">            turretAngle -= deltaAngle;</span>
<span class="fc bfc" id="L340" title="All 2 branches covered.">            if (turretAngle &lt;= 0) {</span>
<span class="fc" id="L341">                turretAngle = 0;</span>
            }
<span class="pc bpc" id="L343" title="1 of 2 branches missed.">        } else if (side == 0) {</span>
<span class="fc" id="L344">            turretAngle += 0;</span>
        }

<span class="fc" id="L347">        turretAngle = turretAngle % 360;</span>
<span class="fc" id="L348">        angleInRadians = (float) Math.toRadians(turretAngle);</span>
<span class="fc" id="L349">        xPosTurret = xPos - (int) (turretLength * Math.cos(angleInRadians));</span>
<span class="fc" id="L350">        yPosTurret = yPos - (float) (turretLength * Math.sin(angleInRadians));</span>
<span class="fc" id="L351">    }</span>

    /**
     * Adjust tank position to be on the terrain
     */
    public void yPosAdjust() {
<span class="fc" id="L357">        yPos = App.getTerrainHeight(xPos, &quot;pixel&quot;);</span>
<span class="fc" id="L358">    }</span>

    /**
     * Start the turret
     */
    public void startTurret() {
<span class="fc" id="L364">        xPosTurret = xPos;</span>
<span class="fc" id="L365">        yPosTurret = yPos - turretLength;</span>
<span class="fc" id="L366">    }</span>

    /**
     * Tank takes damage
     * 
     * @param damage the damage received
     */
    public void takeDamage(float damage) {

<span class="fc bfc" id="L375" title="All 2 branches covered.">        if (health - damage &lt; 0) {</span>
<span class="fc" id="L376">            health = 0;</span>
        } else {
<span class="fc" id="L378">            health -= damage;</span>
        }
<span class="fc" id="L380">    }</span>

    /**
     * Check whether the tank is alive or not
     * 
     * @return isAlive the status whether the tank is alive or not
     */
    public boolean isAlive() {
<span class="pc bpc" id="L388" title="1 of 4 branches missed.">        if (health &lt;= 0 || yPos &gt;= App.getBoard(&quot;height&quot;)) {</span>
<span class="fc" id="L389">            health = 0;</span>
<span class="fc" id="L390">            isAlive = false;</span>
<span class="fc" id="L391">            xPosExploded = xPos;</span>
<span class="fc" id="L392">            yPosExploded = yPos;</span>
        } else {
<span class="fc" id="L394">            isAlive = true;</span>
        }
<span class="fc" id="L396">        return isAlive;</span>
    }

    /**
     * Get the free drop damage
     * 
     * @return free drop damage
     */
    public float getFreeDropDamage() {
<span class="fc" id="L405">        return freeDropDamage;</span>
    }

    /**
     * Reset the free drop damage value
     */
    public void resetFreeDropDamage() {
<span class="fc" id="L412">        freeDropDamage = 0;</span>
<span class="fc" id="L413">    }</span>

    /**
     * Get the tank name
     * 
     * @return tank name
     */
    public String getTankName() {
<span class="fc" id="L421">        return tankName;</span>
    }

    /**
     * Get the current fuel
     * 
     * @return fuel
     */
    public int getFuel() {
<span class="fc" id="L430">        return fuel;</span>
    }

    /**
     * Get the tank power
     * 
     * @return power
     */
    public float getPower() {
<span class="fc" id="L439">        return power;</span>
    }

    /**
     * Get column position
     * 
     * @return column
     */
    public int getCol() {
<span class="fc" id="L448">        return col;</span>
    }

    /**
     * Get row position
     * 
     * @return row
     */
    public int getRow() {
<span class="fc" id="L457">        return row;</span>
    }

    /**
     * Get x position
     * 
     * @return x position of tank
     */
    public int getxPos() {
<span class="fc" id="L466">        return xPos;</span>
    }

    /**
     * Get y position
     * 
     * @return y position of tank
     */
    public float getyPos() {
<span class="fc" id="L475">        return yPos;</span>
    }

    /**
     * Get the x position of turret
     * 
     * @return x position of turret
     */
    public int getxPosTurret() {
<span class="fc" id="L484">        return xPosTurret;</span>
    }

    /**
     * Get the y position of turret
     * 
     * @return y position of turret
     */
    public float getyPosTurret() {
<span class="fc" id="L493">        return yPosTurret;</span>
    }

    /**
     * Get the angle in radian
     * 
     * @return angle in radian
     */
    public float getAngle() {
<span class="fc" id="L502">        return angleInRadians;</span>
    }

    /**
     * Get the health of tank
     * 
     * @return health
     */
    public float getHealth() {
<span class="fc" id="L511">        return health;</span>
    }

    /**
     * Get the angle in degree
     * 
     * @return angle in degree
     */
    public float getTurretAngle() {
<span class="fc" id="L520">        return turretAngle;</span>
    }

    /**
     * Get the remaining parachute
     * 
     * @return parachute
     */
    public int getParachute() {
<span class="fc" id="L529">        return parachute;</span>
    }

    /**
     * The x position of the exploded location
     * 
     * @return x position
     */
    public int getxPosExploded() {
<span class="fc" id="L538">        return xPosExploded;</span>
    }

    /**
     * The y position of the exploded location
     * 
     * @return y position
     */
    public float getyPosExploded() {
<span class="fc" id="L547">        return yPosExploded;</span>
    }

    /**
     * The current state whether tank is ready to fire large projectile or not
     * 
     * @return can fire large projectile or not
     */
    public boolean isLargeProjectile() {
<span class="fc" id="L556">        return largeProjectile;</span>
    }

    /**
     * Whether the explosion has been created
     * 
     * @return explosion state
     */
    public boolean createdExplosion() {
<span class="fc" id="L565">        return createdExplosion;</span>
    }

    /**
     * Set the health of the tank
     * 
     * @param health health of the tank
     */
    public void setHealth(int health) {
<span class="fc" id="L574">        this.health = health;</span>
<span class="fc" id="L575">    }</span>

    /**
     * Set the fuel of the tank
     * 
     * @param fuel fuel of the tank
     */
    public void setFuel(int fuel) {
<span class="fc" id="L583">        this.fuel = fuel;</span>
<span class="fc" id="L584">    }</span>

    /**
     * Set whether the tank can fire large projectile or not
     * 
     * @param side on/off
     */
    public void setLargeProjectile(String side) {
<span class="fc bfc" id="L592" title="All 2 branches covered.">        if (side.equals(&quot;on&quot;)) {</span>
<span class="fc" id="L593">            largeProjectile = true;</span>
<span class="pc bpc" id="L594" title="1 of 2 branches missed.">        } else if (side.equals(&quot;off&quot;)) {</span>
<span class="fc" id="L595">            largeProjectile = false;</span>
        }

<span class="fc" id="L598">    }</span>

    /**
     * Set the parachute deploying state
     */
    public void setParachuteDeployed() {
<span class="fc" id="L604">        isParachuteDeployed = true;</span>
<span class="fc" id="L605">    }</span>

    /**
     * Set the power of tank
     * 
     * @param side increase/decrease/check
     */
    public void setPower(String side) {
<span class="fc bfc" id="L613" title="All 2 branches covered.">        if (side.equals(&quot;increase&quot;)) {</span>
<span class="fc" id="L614">            power += powerChangeSpeed;</span>
<span class="fc bfc" id="L615" title="All 2 branches covered.">        } else if (side.equals(&quot;decrease&quot;)) {</span>
<span class="fc" id="L616">            power -= powerChangeSpeed;</span>
<span class="pc bpc" id="L617" title="1 of 2 branches missed.">        } else if (side.equals(&quot;check&quot;)) {</span>
<span class="fc" id="L618">            power += 0;</span>
        }

<span class="fc" id="L621">        power = Math.max(0, Math.min(power, health));</span>
<span class="fc" id="L622">    }</span>

    /**
     * Set the state of explosion creation
     */
    public void setCreateExplosion() {
<span class="fc" id="L628">        createdExplosion = true;</span>
<span class="fc" id="L629">    }</span>

    /**
     * Set the number of parachute
     * 
     * @param parachute number of parachute
     */
    public void setParachute(int parachute) {
<span class="fc" id="L637">        this.parachute = parachute;</span>
<span class="fc" id="L638">    }</span>

    /**
     * Set the column of the tank
     * 
     * @param col column
     */
    public void setCol(int col) {
<span class="fc" id="L646">        this.col = col;</span>
<span class="fc" id="L647">    }</span>

    /**
     * Set the row of the tank
     * 
     * @param row row
     */
    public void setRow(int row) {
<span class="fc" id="L655">        this.row = row;</span>
<span class="fc" id="L656">    }</span>

    /**
     * Set the y position of the tank
     * 
     * @param yPos y position
     */
    public void setyPos(float yPos) {
<span class="fc" id="L664">        this.yPos = yPos;</span>
<span class="fc" id="L665">    }</span>

    /**
     * Set the turret angle
     * 
     * @param angle angle in degree
     */
    public void setTurretAngle(float angle) {
<span class="fc" id="L673">        this.turretAngle = angle;</span>
<span class="fc" id="L674">    }</span>

    /**
     * Set the tank dead
     */
    public void setIsAlive() {
<span class="fc" id="L680">        this.isAlive = false;</span>
<span class="fc" id="L681">    }</span>

    /**
     * Set the health of the tank
     * 
     * @param health health of the tank
     */
    public void setHealth(float health) {
<span class="fc" id="L689">        this.health = health;</span>
<span class="fc" id="L690">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>